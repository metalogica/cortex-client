{
  "version": 3,
  "sources": ["../src/cortex-handler.ts", "../src/web-socket-client.ts", "../src/cortex.ts", "../src/index.ts"],
  "sourcesContent": ["class CortexHandler {\n  constructor(options) {\n    this.clientId = options.clientId;\n    this.clientSecret = options.clientSecret;\n    this.cortexToken = undefined;\n    this.sessionId = undefined;\n    this.headset = options.headset;\n    this.callbacks = options.callbacks;\n\n    this.webSocketClient = options.webSocketClient;\n  }\n\n  send(response) {\n    this.webSocketClient.send(JSON.stringify(response));\n  }\n\n  authorize(response) {\n    console.log('CortexHandler: authorize function called', response);\n\n    const message = {\n      id: 1,\n      jsonrpc: '2.0',\n      method: 'authorize',\n      params: {\n        clientId: this.clientId,\n        clientSecret: this.clientSecret,\n        debit: 1,\n      },\n    };\n\n    this.send(message);\n  }\n\n  parse(response) {\n    // console.log('CortexHandler: parse function called', response);\n\n    const {data} = response;\n\n    const message = JSON.parse(data);\n\n    // console.log('CortexHandler: parsed the content', message);\n\n    const cortexToken = message?.result?.cortexToken;\n\n    if (cortexToken) {\n      this.cortexToken = cortexToken;\n\n      this._getSessionId();\n    }\n\n    const sessionId = message?.result?.appId && message?.result?.id;\n\n    if (sessionId) {\n      this.sessionId = sessionId;\n\n      this._getStream();\n    }\n\n    const command = message?.com;\n\n    if (command) {\n      const [name, magnitude] = command;\n\n      // console.log('CortexHandler: mental command received', name, magnitude);\n\n      this._handleCallback({name, magnitude});\n    }\n  }\n\n  _handleCallback({name, magnitude}) {\n    const {action: callbackFn} = this.callbacks.find(\n      callback => callback.name === name\n    );\n\n    callbackFn({name, magnitude});\n  }\n\n  _getStream() {\n    const message = {\n      id: 1,\n      jsonrpc: '2.0',\n      method: 'subscribe',\n      params: {\n        cortexToken: this.cortexToken,\n        session: this.sessionId,\n        streams: ['com'],\n      },\n    };\n\n    this.send(message);\n  }\n\n  async _getSessionId() {\n    const message = {\n      id: 1,\n      jsonrpc: '2.0',\n      method: 'createSession',\n      params: {\n        cortexToken: this.cortexToken,\n        headset: this.headset,\n        status: 'active',\n      },\n    };\n\n    this.send(message);\n  }\n}\n\nexport default CortexHandler;\n", "import CortexHandler from './cortex-handler';\n\nexport class WebSocketClient extends WebSocket {\n  constructor(url, options) {\n    super(url);\n\n    this.cortexHandler = new CortexHandler({...options, webSocketClient: this});\n\n    this.clientId = options.clientId;\n    this.clientSecret = options.clientSecret;\n    this.cortexToken = undefined;\n    this.sessionId = undefined;\n    this.headset = options.headset;\n  }\n\n  onopen = function (message) {\n    console.log('ws: onopen fired: ', message);\n\n    this.cortexHandler.authorize();\n  };\n\n  onmessage = function (message) {\n    // console.log('ws: onmessage received: ', message);\n\n    const response = this.cortexHandler.parse(message);\n  };\n\n  onclose = function (message) {\n    console.log('ws: connection closed: ', message);\n  };\n\n  onerror = function (message) {\n    console.error('ws: error: ', message);\n  };\n}\n\nexport default WebSocketClient;\n", "import WebSocketClient from './web-socket-client';\n\nclass Cortex {\n  constructor(options) {\n    this.webSocketClient = WebSocketClient;\n\n    this.options = options;\n    this.url = options.url;\n  }\n\n  stream() {\n    this.webSocketClient = new this.webSocketClient(this.url, this.options);\n  }\n\n  stop() {\n    this.webSocketClient.close();\n  }\n}\n\nmodule.exports = options => new Cortex(options);\n", "import Cortex from './cortex';\n\nconst cortex = Cortex({\n  url: 'wss://localhost:6868',\n  headset: 'EPOCX-E202014A',\n  clientId: 'OagQZeyXwrYoSwQt4JGtGL7HX22U2vJQDnpW6sOK',\n  clientSecret:\n    'WNhMfomUciXSJovRXPYEnPZrHq5ETDvR73FVSxlBMRHXbrfBm6q0z0W6l07oj7BchXcVmWQ6Yvd31ipR6ybn6lfxx8aNJjcnSNrBa0M5PUuuxC9BvEocGCjdJsG41nv2',\n\n  callbacks: [\n    {\n      name: 'neutral',\n      action: ({name, magnitude}) =>\n        console.log('CallbackFn: it fired: neutral', name, magnitude + 5),\n    },\n    {\n      name: 'lift',\n      action: ({name, magnitude}) =>\n        console.log('Callback: it fired: lift', name, magnitude),\n    },\n  ],\n});\n\nconsole.log('cortex class: ', cortex);\n\ncortex.stream();\n"],
  "mappings": "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",
  "names": []
}
